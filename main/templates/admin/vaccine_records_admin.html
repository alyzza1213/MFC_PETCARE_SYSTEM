{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Vaccine Records | MFC Pet Life</title>
<link rel="stylesheet" href="{% static 'css/admin/vaccine_records_admin.css' %}">

</head>
<body>

<div class="sidebar">
    <h2>MFC Pet Life</h2>
    <a href="{% url 'admin_dashboard' %}">Dashboard</a>
    <a href="{% url 'clients_pets' %}">Clients & Pets</a>
    <a href="{% url 'appointment_list' %}">Appointments</a>
    <a href="{% url 'logout' %}">Logout</a>
</div>

<div class="main-content">
    <h1>Vaccination Records</h1>
    <h3 class="pet-name">{{ pet.name }} ({{ pet.species }})</h3>

    <table>
        <thead>
            <tr>
                <th>Date Given</th>
                <th>Next Vaccination</th>
                <th>Weight</th>
                <th>Vaccine</th>
                <th>Manufacturer</th>
                <th>Veterinarian</th>
                {% if user.is_staff %}<th>Actions</th>{% endif %}
            </tr>
        </thead>
        <tbody>
        {% for record in pet.vaccine_records.all %}
            <tr>
                {% if user.is_staff %}
               
                <form method="post" action="{% url 'update_vaccine' record.id %}">
                    {% csrf_token %}
                    <td><input type="date" name="date_given" value="{{ record.date_given|date:'Y-m-d' }}" required></td>
                    <td><input type="date" name="next_due" value="{{ record.next_due|date:'Y-m-d' }}"></td>
                    <td><input type="number" name="weight" value="{{ record.weight }}" step="0.1" required></td>
                    <td><input type="text" name="vaccine_name" value="{{ record.vaccine_name }}" required></td>
                    <td><input type="text" name="manufacturer" value="{{ record.manufacturer }}"></td>
                    <td><input type="text" name="veterinarian" value="{{ record.veterinarian }}"></td>
                    <td>
                        <button type="submit" class="btn-update">UPDATE</button>
                    </td>
                </form>

             
                <form method="post" action="{% url 'delete_vaccine' record.id %}" style="display:inline;">
                    {% csrf_token %}
                    <td>
                        <button type="submit" class="btn-delete" onclick="return confirm('Delete this record?')">DELETE</button>
                    </td>
                </form>
                {% endif %}
            </tr>
        {% empty %}
            <tr>
                <td colspan="7" style="text-align:center;color:#777;">No vaccination records yet.</td>
            </tr>
        {% endfor %}

        {% if user.is_staff %}
        
        <tr>
            <form method="post" action="{% url 'add_vaccine' pet.id %}">
                {% csrf_token %}
                <td><input type="date" name="date_given" required></td>
                <td><input type="date" name="next_due"></td>
                <td><input type="number" name="weight" step="0.1" required></td>
                <td><input type="text" name="vaccine_name" required></td>
                <td><input type="text" name="manufacturer"></td>
                <td><input type="text" name="veterinarian"></td>
                <td><button type="submit" class="btn-save">SAVE</button></td>
            </form>
        </tr>
        {% endif %}
        </tbody>
    </table>
</div>

</body>
</html>
